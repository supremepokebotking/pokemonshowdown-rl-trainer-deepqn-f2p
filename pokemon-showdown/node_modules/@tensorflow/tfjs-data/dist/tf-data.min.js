/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@tensorflow/tfjs-core")):"function"==typeof define&&define.amd?define(["exports","@tensorflow/tfjs-core"],e):e((t.tf=t.tf||{},t.tf.data=t.tf.data||{}),t.tf)}(this,function(t,e){"use strict";var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function i(t,e,r,n){return new(r||(r=Promise))(function(i,o){function s(t){try{a(n.next(t))}catch(t){o(t)}}function u(t){try{a(n.throw(t))}catch(t){o(t)}}function a(t){t.done?i(t.value):new r(function(e){e(t.value)}).then(s,u)}a((n=n.apply(t,e||[])).next())})}function o(t,e){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}var s="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function u(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function a(t,e){return t(e={exports:{}},e.exports),e.exports}var h=a(function(t){!function(t,e,r){function n(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function i(t,e){var r=new function(t){var e,r=this,n=(e=4022871197,function(t){t=t.toString();for(var r=0;r<t.length;r++){var n=.02519603282416938*(e+=t.charCodeAt(r));n-=e=n>>>0,e=(n*=e)>>>0,e+=4294967296*(n-=e)}return 2.3283064365386963e-10*(e>>>0)});r.next=function(){var t=2091639*r.s0+2.3283064365386963e-10*r.c;return r.s0=r.s1,r.s1=r.s2,r.s2=t-(r.c=0|t)},r.c=1,r.s0=n(" "),r.s1=n(" "),r.s2=n(" "),r.s0-=n(t),r.s0<0&&(r.s0+=1),r.s1-=n(t),r.s1<0&&(r.s1+=1),r.s2-=n(t),r.s2<0&&(r.s2+=1),n=null}(t),i=e&&e.state,o=r.next;return o.int32=function(){return 4294967296*r.next()|0},o.double=function(){return o()+1.1102230246251565e-16*(2097152*o()|0)},o.quick=o,i&&("object"==typeof i&&n(i,r),o.state=function(){return n(r,{})}),o}e&&e.exports?e.exports=i:r&&r.amd?r(function(){return i}):this.alea=i}(0,t,!1)}),c=a(function(t){!function(t,e,r){function n(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function i(t,e){var r=new function(t){var e=this,r="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:r+=t;for(var n=0;n<r.length+64;n++)e.x^=0|r.charCodeAt(n),e.next()}(t),i=e&&e.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=r.next,o.quick=o,i&&("object"==typeof i&&n(i,r),o.state=function(){return n(r,{})}),o}e&&e.exports?e.exports=i:r&&r.amd?r(function(){return i}):this.xor128=i}(0,t,!1)}),f=a(function(t){!function(t,e,r){function n(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function i(t,e){var r=new function(t){var e=this,r="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:r+=t;for(var n=0;n<r.length+64;n++)e.x^=0|r.charCodeAt(n),n==r.length&&(e.d=e.x<<10^e.x>>>4),e.next()}(t),i=e&&e.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=r.next,o.quick=o,i&&("object"==typeof i&&n(i,r),o.state=function(){return n(r,{})}),o}e&&e.exports?e.exports=i:r&&r.amd?r(function(){return i}):this.xorwow=i}(0,t,!1)}),l=a(function(t){!function(t,e,r){function n(t,e){return e.x=t.x.slice(),e.i=t.i,e}function i(t,e){null==t&&(t=+new Date);var r=new function(t){var e=this;e.next=function(){var t,r,n=e.x,i=e.i;return t=n[i],r=(t^=t>>>7)^t<<24,r^=(t=n[i+1&7])^t>>>10,r^=(t=n[i+3&7])^t>>>3,r^=(t=n[i+4&7])^t<<7,t=n[i+7&7],r^=(t^=t<<13)^t<<9,n[i]=r,e.i=i+1&7,r},function(t,e){var r,n=[];if(e===(0|e))n[0]=e;else for(e=""+e,r=0;r<e.length;++r)n[7&r]=n[7&r]<<15^e.charCodeAt(r)+n[r+1&7]<<13;for(;n.length<8;)n.push(0);for(r=0;r<8&&0===n[r];++r);for(8==r?n[7]=-1:n[r],t.x=n,t.i=0,r=256;r>0;--r)t.next()}(e,t)}(t),i=e&&e.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=r.next,o.quick=o,i&&(i.x&&n(i,r),o.state=function(){return n(r,{})}),o}e&&e.exports?e.exports=i:r&&r.amd?r(function(){return i}):this.xorshift7=i}(0,t,!1)}),p=a(function(t){!function(t,e,r){function n(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function i(t,e){null==t&&(t=+new Date);var r=new function(t){var e=this;e.next=function(){var t,r,n=e.w,i=e.X,o=e.i;return e.w=n=n+1640531527|0,r=i[o+34&127],t=i[o=o+1&127],r^=r<<13,t^=t<<17,r^=r>>>15,t^=t>>>12,r=i[o]=r^t,e.i=o,r+(n^n>>>16)|0},function(t,e){var r,n,i,o,s,u=[],a=128;for(e===(0|e)?(n=e,e=null):(e+="\0",n=0,a=Math.max(a,e.length)),i=0,o=-32;o<a;++o)e&&(n^=e.charCodeAt((o+32)%e.length)),0===o&&(s=n),n^=n<<10,n^=n>>>15,n^=n<<4,n^=n>>>13,o>=0&&(s=s+1640531527|0,i=0==(r=u[127&o]^=n+s)?i+1:0);for(i>=128&&(u[127&(e&&e.length||0)]=-1),i=127,o=512;o>0;--o)n=u[i+34&127],r=u[i=i+1&127],n^=n<<13,r^=r<<17,n^=n>>>15,r^=r>>>12,u[i]=n^r;t.w=s,t.X=u,t.i=i}(e,t)}(t),i=e&&e.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=r.next,o.quick=o,i&&(i.X&&n(i,r),o.state=function(){return n(r,{})}),o}e&&e.exports?e.exports=i:r&&r.amd?r(function(){return i}):this.xor4096=i}(0,t,!1)}),d=a(function(t){!function(t,e,r){function n(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function i(t,e){var r=new function(t){var e=this,r="";e.next=function(){var t=e.b,r=e.c,n=e.d,i=e.a;return t=t<<25^t>>>7^r,r=r-n|0,n=n<<24^n>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^r,e.c=r=r-n|0,e.d=n<<16^r>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):r+=t;for(var n=0;n<r.length+20;n++)e.b^=0|r.charCodeAt(n),e.next()}(t),i=e&&e.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=r.next,o.quick=o,i&&("object"==typeof i&&n(i,r),o.state=function(){return n(r,{})}),o}e&&e.exports?e.exports=i:r&&r.amd?r(function(){return i}):this.tychei=i}(0,t,!1)}),y=a(function(t){!function(e,r){var n,i=(0,eval)("this"),o=256,s=6,u="random",a=r.pow(o,s),h=r.pow(2,52),c=2*h,f=o-1;function l(t,l,v){var m=[],w=d(function t(e,r){var n,i=[],o=typeof e;if(r&&"object"==o)for(n in e)try{i.push(t(e[n],r-1))}catch(t){}return i.length?i:"string"==o?e:e+"\0"}((l=1==l?{entropy:!0}:l||{}).entropy?[t,y(e)]:null==t?function(){try{var t;return n&&(t=n.randomBytes)?t=t(o):(t=new Uint8Array(o),(i.crypto||i.msCrypto).getRandomValues(t)),y(t)}catch(t){var r=i.navigator,s=r&&r.plugins;return[+new Date,i,s,i.screen,y(e)]}}():t,3),m),g=new function(t){var e,r=t.length,n=this,i=0,s=n.i=n.j=0,u=n.S=[];r||(t=[r++]);for(;i<o;)u[i]=i++;for(i=0;i<o;i++)u[i]=u[s=f&s+t[i%r]+(e=u[i])],u[s]=e;(n.g=function(t){for(var e,r=0,i=n.i,s=n.j,u=n.S;t--;)e=u[i=f&i+1],r=r*o+u[f&(u[i]=u[s=f&s+e])+(u[s]=e)];return n.i=i,n.j=s,r})(o)}(m),b=function(){for(var t=g.g(s),e=a,r=0;t<h;)t=(t+r)*o,e*=o,r=g.g(1);for(;t>=c;)t/=2,e/=2,r>>>=1;return(t+r)/e};return b.int32=function(){return 0|g.g(4)},b.quick=function(){return g.g(4)/4294967296},b.double=b,d(y(g.S),e),(l.pass||v||function(t,e,n,i){return i&&(i.S&&p(i,g),t.state=function(){return p(g,{})}),n?(r[u]=t,e):t})(b,w,"global"in l?l.global:this==r,l.state)}function p(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function d(t,e){for(var r,n=t+"",i=0;i<n.length;)e[f&i]=f&(r^=19*e[f&i])+n.charCodeAt(i++);return y(e)}function y(t){return String.fromCharCode.apply(0,t)}if(r["seed"+u]=l,d(r.random(),e),t.exports){t.exports=l;try{n=require("crypto")}catch(t){}}else 0}([],Math)});y.alea=h,y.xor128=c,y.xorwow=f,y.xorshift7=l,y.xor4096=p,y.tychei=d;var v=y.alea,m=a(function(t,e){function r(t){for(var e=t.length,r=0,n=0;e>0;)n=Math.random()*e|0,r=t[--e],t[e]=t[n],t[n]=r}function n(t,e){if(!t)throw new Error("string"==typeof e?e:e())}function i(t,e){if(void 0===e&&(e=[]),Array.isArray(t)||h(t))for(var r=0;r<t.length;++r)i(t[r],e);else e.push(t);return e}function o(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(var r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function s(t){return t%1==0}function u(t,e){var r=e.length;return n((t=null==t?e.map(function(t,e){return e}):[].concat(t)).every(function(t){return t>=-r&&t<r}),"All values in axis param must be in range [-"+r+", "+r+") but got axis "+t),n(t.every(function(t){return s(t)}),"All values in axis param must be integers but got axis "+t),t.map(function(t){return t<0?r+t:t})}function a(t,e){for(var r=0;r<t.length;r++){var n=t[r];if(isNaN(n)||!isFinite(n))throw Error("A tensor of type "+e+" being uploaded contains "+n+".")}}function h(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array}function c(t){return"string"==typeof t||t instanceof String}function f(t){return"boolean"==typeof t}function l(t){return"number"==typeof t}function p(t,e){if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e)return new Uint8Array(t);throw new Error("Unknown data type "+e)}Object.defineProperty(e,"__esModule",{value:!0}),e.shuffle=r,e.clamp=function(t,e,r){return Math.max(t,Math.min(e,r))},e.nearestLargerEven=function(t){return t%2==0?t:t+1},e.sum=function(t){for(var e=0,r=0;r<t.length;r++)e+=t[r];return e},e.randUniform=function(t,e){var r=Math.random();return e*r+(1-r)*t},e.distSquared=function(t,e){for(var r=0,n=0;n<t.length;n++){var i=Number(t[n])-Number(e[n]);r+=i*i}return r},e.assert=n,e.assertShapesMatch=function(t,e,r){void 0===r&&(r=""),n(o(t,e),r+" Shapes "+t+" and "+e+" must match")},e.assertNonNull=function(t){n(null!=t,"The input to the tensor constructor must be a non-null value.")},e.flatten=i,e.sizeFromShape=function(t){if(0===t.length)return 1;for(var e=t[0],r=1;r<t.length;r++)e*=t[r];return e},e.isScalarShape=function(t){return 0===t.length},e.arraysEqual=o,e.isInt=s,e.tanh=function(t){if(null!=Math.tanh)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;var e=Math.exp(2*t);return(e-1)/(e+1)},e.sizeToSquarishShape=function(t){var e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]},e.createShuffledIndices=function(t){for(var e=new Uint32Array(t),n=0;n<t;++n)e[n]=n;return r(e),e},e.rightPad=function(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)},e.repeatedTry=function(t,e,r){return void 0===e&&(e=function(t){return 0}),new Promise(function(n,i){var o=0,s=function(){if(t())n();else{var u=e(++o);null!=r&&o>=r?i():setTimeout(s,u)}};s()})},e.inferFromImplicitShape=function(t,e){for(var r=1,n=-1,i=0;i<t.length;++i)if(t[i]>=0)r*=t[i];else if(-1===t[i]){if(-1!==n)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+n+" and dim "+i);n=i}else if(t[i]<0)throw Error("Shapes can not be < 0. Found "+t[i]+" at dim "+i);if(-1===n){if(e>0&&e!==r)throw Error("Size("+e+") must match the product of shape "+t);return t}if(0===r)throw Error("Cannot infer the missing size in ["+t+"] when there are 0 elements");if(e%r!=0)throw Error("The implicit shape can't be a fractional number. Got "+e+" / "+r);var o=t.slice();return o[n]=e/r,o},e.parseAxisParam=u,e.squeezeShape=function(t,e){for(var r=[],n=[],i=null==e?null:u(e,t).sort(),o=0,s=0;s<t.length;++s){if(null!=i){if(i[o]===s&&1!==t[s])throw new Error("Can't squeeze axis "+s+" since its dim '"+t[s]+"' is not 1");(null==i[o]||i[o]>s)&&1===t[s]&&(r.push(t[s]),n.push(s)),i[o]<=s&&o++}1!==t[s]&&(r.push(t[s]),n.push(s))}return{newShape:r,keptDims:n}},e.getTypedArrayFromDType=function(t,e){var r=null;if(null==t||"float32"===t)r=new Float32Array(e);else if("int32"===t)r=new Int32Array(e);else{if("bool"!==t)throw new Error("Unknown data type "+t);r=new Uint8Array(e)}return r},e.getArrayFromDType=function(t,e){var r=null;if(null==t||"float32"===t)r=new Float32Array(e);else if("int32"===t)r=new Int32Array(e);else if("bool"===t)r=new Uint8Array(e);else{if("string"!==t)throw new Error("Unknown data type "+t);r=new Array(e)}return r},e.checkComputationForErrors=function(t,e,r){if("float32"===e)for(var n=0;n<t.length;n++){var i=t[n];if(isNaN(i)||!isFinite(i))throw Error("The result of the '"+r+"' is "+i+".")}},e.checkConversionForErrors=a,e.hasEncodingLoss=function(t,e){return!("complex64"===e||"float32"===e&&"complex64"!==t||"int32"===e&&"float32"!==t&&"complex64"!==t||"bool"===e&&"bool"===t)},e.isTypedArray=h,e.bytesPerElement=function(t){if("float32"===t||"int32"===t)return 4;if("complex64"===t)return 8;if("bool"===t)return 1;throw new Error("Unknown dtype "+t)},e.bytesFromStringArray=function(t){if(null==t)return 0;var e=0;return t.forEach(function(t){return e+=2*t.length}),e},e.isString=c,e.isBoolean=f,e.isNumber=l,e.inferDtype=function t(e){return Array.isArray(e)?t(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":l(e)?"float32":c(e)?"string":f(e)?"bool":"float32"},e.isFunction=function(t){return!!(t&&t.constructor&&t.call&&t.apply)},e.nearestDivisor=function(t,e){for(var r=e;r<t;++r)if(t%r==0)return r;return t},e.computeStrides=function(t){var e=t.length;if(e<2)return[];var r=new Array(e-1);r[e-2]=t[e-1];for(var n=e-3;n>=0;--n)r[n]=r[n+1]*t[n+1];return r},e.toTypedArray=function(t,e,r){if("string"===e)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=i(t)),r&&a(t,e),function(t,e){return t instanceof Float32Array&&"float32"===e||t instanceof Int32Array&&"int32"===e||t instanceof Uint8Array&&"bool"===e}(t,e))return t;if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e){for(var n=new Uint8Array(t.length),o=0;o<n.length;++o)0!==Math.round(t[o])&&(n[o]=1);return n}throw new Error("Unknown data type "+e)},e.toNestedArray=function(t,e){if(0===t.length)return[];var r=t.reduce(function(t,e){return t*e});if(0===r)return[];if(r!==e.length)throw new Error("["+t+"] does not match the input size.");return function t(e,r,n){var i=new Array;if(1===r.length)for(var o=r[0],s=0;s<o;s++)i[s]=n[e+s];else{o=r[0];var u=r.slice(1),a=u.reduce(function(t,e){return t*e});for(s=0;s<o;s++)i[s]=t(e+s*a,u,n)}return i}(0,t,e)},e.makeOnesTypedArray=function(t,e){for(var r=p(t,e),n=0;n<r.length;n++)r[n]=1;return r},e.makeZerosTypedArray=p,e.now=function(){if("undefined"!=typeof performance)return performance.now();if("undefined"!=typeof process){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6}throw new Error("Cannot measure time in this environment. You should run tf.js in the browser or in Node.js")},e.monitorPromisesProgress=function(t,e,r,i){!function(t){n(null!=t&&Array.isArray(t)&&t.length>0,"promises must be a none empty array")}(t),function(t,e){n(t>=0&&t<=1,"Progress fraction must be in range [0, 1], but got startFraction "+t),n(e>=0&&e<=1,"Progress fraction must be in range [0, 1], but got endFraction "+e),n(e>=t,"startFraction must be no more than endFraction, but got startFraction "+t+" and endFraction "+e)}(r=null==r?0:r,i=null==i?1:i);var o=0;return Promise.all(t.map(function(n){return n.then(function(n){var s=r+ ++o/t.length*(i-r);return e(s),n}),n}))}});u(m);m.shuffle,m.clamp,m.nearestLargerEven,m.sum,m.randUniform,m.distSquared,m.assert,m.assertShapesMatch,m.assertNonNull,m.flatten,m.sizeFromShape,m.isScalarShape,m.arraysEqual,m.isInt,m.tanh,m.sizeToSquarishShape,m.createShuffledIndices,m.rightPad,m.repeatedTry,m.inferFromImplicitShape,m.parseAxisParam,m.squeezeShape,m.getTypedArrayFromDType,m.getArrayFromDType,m.checkComputationForErrors,m.checkConversionForErrors,m.hasEncodingLoss,m.isTypedArray,m.bytesPerElement,m.bytesFromStringArray,m.isString,m.isBoolean,m.isNumber,m.inferDtype,m.isFunction,m.nearestDivisor,m.computeStrides,m.toTypedArray,m.toNestedArray,m.makeOnesTypedArray,m.makeZerosTypedArray,m.now,m.monitorPromisesProgress;var w=a(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=20,n=3,i=7;function o(t,e){var r;return r=Array.isArray(t)?parseFloat(t[0].toFixed(i))+" + "+parseFloat(t[1].toFixed(i))+"j":m.isString(t)?"'"+t+"'":parseFloat(t.toFixed(i)).toString(),m.rightPad(r,e)}function s(t){for(var e=[],r=0;r<t.length;r+=2)e.push([t[r],t[r+1]]);return e}e.tensorToString=function(t,e,i,u){var a=m.computeStrides(e),h=function(t,e,r,n){var i=m.sizeFromShape(e),u=n[n.length-1],a=new Array(u).fill(0),h=e.length,c="complex64"===r?s(t):t;if(h>1)for(var f=0;f<i/u;f++)for(var l=f*u,p=0;p<u;p++)a[p]=Math.max(a[p],o(c[l+p],0).length);return a}(t,e,i,a),c=e.length,f=function t(e,i,u,a,h,c){void 0===c&&(c=!0);var f="complex64"===u?2:1,l=i[0],p=i.length;if(0===p){if("complex64"===u){var d=s(e);return[o(d[0],0)]}return[e[0].toString()]}if(1===p){if(l>r){var y=n*f,v=Array.from(e.slice(0,y)),m=Array.from(e.slice(l-n*f,l));return"complex64"===u&&(v=s(v),m=s(m)),["["+v.map(function(t,e){return o(t,h[e])}).join(", ")+", ..., "+m.map(function(t,e){return o(t,h[l-n+e])}).join(", ")+"]"]}var w="complex64"===u?s(e):Array.from(e);return["["+w.map(function(t,e){return o(t,h[e])}).join(", ")+"]"]}var g=i.slice(1),b=a.slice(1),x=a[0]*f,I=[];if(l>r){for(var D=0;D<n;D++){var S=D*x,A=S+x;I.push.apply(I,t(e.slice(S,A),g,u,b,h,!1))}I.push("...");for(var D=l-n;D<l;D++){var S=D*x,A=S+x;I.push.apply(I,t(e.slice(S,A),g,u,b,h,D===l-1))}}else for(var D=0;D<l;D++){var S=D*x,A=S+x;I.push.apply(I,t(e.slice(S,A),g,u,b,h,D===l-1))}var T=2===p?",":"";I[0]="["+I[0]+T;for(var D=1;D<I.length-1;D++)I[D]=" "+I[D]+T;for(var E=",\n",D=2;D<p;D++)E+="\n";return I[I.length-1]=" "+I[I.length-1]+"]"+(c?"":E),I}(t,e,i,a,h),l=["Tensor"];return u&&(l.push("  dtype: "+i),l.push("  rank: "+c),l.push("  shape: ["+e+"]"),l.push("  values:")),l.push(f.map(function(t){return"    "+t}).join("\n")),l.join("\n")}});u(w);w.tensorToString;var g=a(function(t,e){var r,n=s&&s.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=s&&s.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(i,o){function s(t){try{a(n.next(t))}catch(t){o(t)}}function u(t){try{a(n.throw(t))}catch(t){o(t)}}function a(t){t.done?i(t.value):new r(function(e){e(t.value)}).then(s,u)}a((n=n.apply(t,e||[])).next())})},o=s&&s.__generator||function(t,e){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}};Object.defineProperty(e,"__esModule",{value:!0});var u=m,a=function(){function t(t,e,r){if(this.dtype=e,this.shape=t.slice(),this.size=m.sizeFromShape(t),null!=r){var n=r.length;m.assert(n===this.size,"Length of values '"+n+"' does not match the size inferred by the shape '"+this.size+"'.")}if("complex64"===e)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||m.getArrayFromDType(e,m.sizeFromShape(this.shape)),this.strides=u.computeStrides(t)}return t.prototype.set=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];0===e.length&&(e=[0]),m.assert(e.length===this.rank,"The number of provided coordinates ("+e.length+") must match the rank ("+this.rank+")");var n=this.locToIndex(e);this.values[n]=t},t.prototype.get=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];0===t.length&&(t=[0]);for(var r=t[t.length-1],n=0;n<t.length-1;++n)r+=this.strides[n]*t[n];return this.values[r]},t.prototype.locToIndex=function(t){if(0===this.rank)return 0;if(1===this.rank)return t[0];for(var e=t[t.length-1],r=0;r<t.length-1;++r)e+=this.strides[r]*t[r];return e},t.prototype.indexToLoc=function(t){if(0===this.rank)return[];if(1===this.rank)return[t];for(var e=new Array(this.shape.length),r=0;r<e.length-1;++r)e[r]=Math.floor(t/this.strides[r]),t-=e[r]*this.strides[r];return e[e.length-1]=t,e},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.toTensor=function(){return l.make(this.shape,{values:this.values},this.dtype)},t}();e.TensorBuffer=a;var h=null,c=null,f=null;e.setTensorTracker=function(t){h=t},e.setOpHandler=function(t){c=t},e.setDeprecationWarningFn=function(t){f=t};var l=function(){function t(t,e,r,n){this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=m.sizeFromShape(t),this.strides=u.computeStrides(t),this.dataId=null!=n?n:{},this.id=h().nextTensorId(),this.rankType=this.rank<5?this.rank.toString():"higher",h().registerTensor(this),null!=r&&h().write(this.dataId,r)}return t.make=function(e,r,n){return new t(e,n,r.values,r.dataId)},t.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},t.prototype.asScalar=function(){return this.throwIfDisposed(),m.assert(1===this.size,"The array must have only 1 element."),this.reshape([])},t.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},t.prototype.as2D=function(t,e){return this.throwIfDisposed(),this.reshape([t,e])},t.prototype.as3D=function(t,e,r){return this.throwIfDisposed(),this.reshape([t,e,r])},t.prototype.as4D=function(t,e,r,n){return this.throwIfDisposed(),this.reshape([t,e,r,n])},t.prototype.as5D=function(t,e,r,n,i){return this.throwIfDisposed(),this.reshape([t,e,r,n,i])},t.prototype.asType=function(t){return this.throwIfDisposed(),c.cast(this,t)},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.get=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];f("Tensor.get() is deprecated. Use Tensor.array() and native array indexing instead."),m.assert(t.length===this.rank,"Number of coordinates in get() must match the rank of the tensor"),m.assert("complex64"!==this.dtype,"Tensor.get() is not supported for complex64 tensors yet."),this.throwIfDisposed(),0===t.length&&(t=[0]);for(var r=t[t.length-1],n=0;n<t.length-1;++n)r+=this.strides[n]*t[n];return this.dataSync()[r]},t.prototype.buffer=function(){return f("Tensor.buffer() is renamed to Tensor.bufferSync() in TensorFlow.js 1.0 and Tensor.buffer() will become an async function."),c.buffer(this.shape,this.dtype,this.dataSync())},t.prototype.bufferSync=function(){return c.buffer(this.shape,this.dtype,this.dataSync())},t.prototype.array=function(){return i(this,void 0,void 0,function(){var t,e;return o(this,function(r){switch(r.label){case 0:return t=u.toNestedArray,e=[this.shape],[4,this.data()];case 1:return[2,t.apply(void 0,e.concat([r.sent()]))]}})})},t.prototype.arraySync=function(){return u.toNestedArray(this.shape,this.dataSync())},t.prototype.data=function(){return i(this,void 0,void 0,function(){return o(this,function(t){return this.throwIfDisposed(),[2,h().read(this.dataId)]})})},t.prototype.dataSync=function(){return this.throwIfDisposed(),h().readSync(this.dataId)},t.prototype.dispose=function(){this.isDisposed||(h().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(t.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),t.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},t.prototype.toFloat=function(){return this.asType("float32")},t.prototype.toInt=function(){return this.asType("int32")},t.prototype.toBool=function(){return this.asType("bool")},t.prototype.print=function(t){return void 0===t&&(t=!1),c.print(this,t)},t.prototype.reshape=function(t){return this.throwIfDisposed(),c.reshape(this,t)},t.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},t.prototype.expandDims=function(t){return void 0===t&&(t=0),c.expandDims(this,t)},t.prototype.cumsum=function(t,e,r){return void 0===t&&(t=0),void 0===e&&(e=!1),void 0===r&&(r=!1),c.cumsum(this,t,e,r)},t.prototype.squeeze=function(t){return this.throwIfDisposed(),c.squeeze(this,t)},t.prototype.clone=function(){return this.throwIfDisposed(),c.clone(this)},t.prototype.oneHot=function(t,e,r){return this.throwIfDisposed(),c.oneHot(this,t,e,r)},t.prototype.toString=function(t){void 0===t&&(t=!1);var e=this.dataSync();return w.tensorToString(e,this.shape,this.dtype,t)},t.prototype.tile=function(t){return this.throwIfDisposed(),c.tile(this,t)},t.prototype.gather=function(t,e){return void 0===e&&(e=0),this.throwIfDisposed(),c.gather(this,t,e)},t.prototype.matMul=function(t,e,r){return void 0===e&&(e=!1),void 0===r&&(r=!1),this.throwIfDisposed(),c.matMul(this,t,e,r)},t.prototype.dot=function(t){return this.throwIfDisposed(),c.dot(this,t)},t.prototype.norm=function(t,e,r){return void 0===t&&(t="euclidean"),void 0===e&&(e=null),void 0===r&&(r=!1),this.throwIfDisposed(),c.norm(this,t,e,r)},t.prototype.slice=function(t,e){return this.throwIfDisposed(),c.slice(this,t,e)},t.prototype.reverse=function(t){return this.throwIfDisposed(),c.reverse(this,t)},t.prototype.concat=function(e,r){return void 0===r&&(r=0),this.throwIfDisposed(),e instanceof t&&(e=[e]),c.concat([this].concat(e),r)},t.prototype.split=function(t,e){return void 0===e&&(e=0),this.throwIfDisposed(),c.split(this,t,e)},t.prototype.stack=function(t,e){return void 0===e&&(e=0),c.stack([this,t],e)},t.prototype.unstack=function(t,e){return void 0===e&&(e=0),c.unstack(this,e)},t.prototype.pad=function(t,e){return void 0===e&&(e=0),c.pad(this,t,e)},t.prototype.batchNormalization=function(t,e,r,n,i){return void 0===r&&(r=.001),f("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,e,i,n,r)},t.prototype.batchNorm=function(t,e,r,n,i){return void 0===i&&(i=.001),this.throwIfDisposed(),c.batchNorm(this,t,e,r,n,i)},t.prototype.all=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),c.all(this,t,e)},t.prototype.any=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),c.any(this,t,e)},t.prototype.logSumExp=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),c.logSumExp(this,t,e)},t.prototype.sum=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),c.sum(this,t,e)},t.prototype.prod=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),c.prod(this,t,e)},t.prototype.mean=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),c.mean(this,t,e)},t.prototype.min=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),c.min(this,t,e)},t.prototype.max=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),c.max(this,t,e)},t.prototype.argMin=function(t){return void 0===t&&(t=null),this.throwIfDisposed(),c.argMin(this,t)},t.prototype.argMax=function(t){return void 0===t&&(t=null),this.throwIfDisposed(),c.argMax(this,t)},t.prototype.cast=function(t){return this.throwIfDisposed(),c.cast(this,t)},t.prototype.add=function(t){return this.throwIfDisposed(),c.add(this,t)},t.prototype.addStrict=function(t){return this.throwIfDisposed(),c.addStrict(this,t)},t.prototype.atan2=function(t){return this.throwIfDisposed(),c.atan2(this,t)},t.prototype.sub=function(t){return this.throwIfDisposed(),c.sub(this,t)},t.prototype.subStrict=function(t){return this.throwIfDisposed(),c.subStrict(this,t)},t.prototype.pow=function(t){return this.throwIfDisposed(),c.pow(this,t)},t.prototype.powStrict=function(t){return this.throwIfDisposed(),c.powStrict(this,t)},t.prototype.mul=function(t){return this.throwIfDisposed(),c.mul(this,t)},t.prototype.mulStrict=function(t){return this.throwIfDisposed(),c.mulStrict(this,t)},t.prototype.div=function(t){return this.throwIfDisposed(),c.div(this,t)},t.prototype.floorDiv=function(t){return this.throwIfDisposed(),c.floorDiv(this,t)},t.prototype.divStrict=function(t){return this.throwIfDisposed(),c.divStrict(this,t)},t.prototype.minimum=function(t){return this.throwIfDisposed(),c.minimum(this,t)},t.prototype.minimumStrict=function(t){return this.throwIfDisposed(),c.minimumStrict(this,t)},t.prototype.maximum=function(t){return this.throwIfDisposed(),c.maximum(this,t)},t.prototype.maximumStrict=function(t){return this.throwIfDisposed(),c.maximumStrict(this,t)},t.prototype.mod=function(t){return this.throwIfDisposed(),c.mod(this,t)},t.prototype.modStrict=function(t){return this.throwIfDisposed(),c.modStrict(this,t)},t.prototype.squaredDifference=function(t){return this.throwIfDisposed(),c.squaredDifference(this,t)},t.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),c.squaredDifferenceStrict(this,t)},t.prototype.transpose=function(t){return this.throwIfDisposed(),c.transpose(this,t)},t.prototype.notEqual=function(t){return this.throwIfDisposed(),c.notEqual(this,t)},t.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),c.notEqualStrict(this,t)},t.prototype.less=function(t){return this.throwIfDisposed(),c.less(this,t)},t.prototype.lessStrict=function(t){return this.throwIfDisposed(),c.lessStrict(this,t)},t.prototype.equal=function(t){return this.throwIfDisposed(),c.equal(this,t)},t.prototype.equalStrict=function(t){return this.throwIfDisposed(),c.equalStrict(this,t)},t.prototype.lessEqual=function(t){return this.throwIfDisposed(),c.lessEqual(this,t)},t.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),c.lessEqualStrict(this,t)},t.prototype.greater=function(t){return this.throwIfDisposed(),c.greater(this,t)},t.prototype.greaterStrict=function(t){return this.throwIfDisposed(),c.greaterStrict(this,t)},t.prototype.greaterEqual=function(t){return this.throwIfDisposed(),c.greaterEqual(this,t)},t.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),c.greaterEqualStrict(this,t)},t.prototype.logicalAnd=function(t){return this.throwIfDisposed(),c.logicalAnd(this,t)},t.prototype.logicalOr=function(t){return this.throwIfDisposed(),c.logicalOr(this,t)},t.prototype.logicalNot=function(){return this.throwIfDisposed(),c.logicalNot(this)},t.prototype.logicalXor=function(t){return this.throwIfDisposed(),c.logicalXor(this,t)},t.prototype.where=function(t,e){return this.throwIfDisposed(),c.where(t,this,e)},t.prototype.neg=function(){return this.throwIfDisposed(),c.neg(this)},t.prototype.ceil=function(){return this.throwIfDisposed(),c.ceil(this)},t.prototype.floor=function(){return this.throwIfDisposed(),c.floor(this)},t.prototype.sign=function(){return this.throwIfDisposed(),c.sign(this)},t.prototype.exp=function(){return this.throwIfDisposed(),c.exp(this)},t.prototype.expm1=function(){return this.throwIfDisposed(),c.expm1(this)},t.prototype.log=function(){return this.throwIfDisposed(),c.log(this)},t.prototype.log1p=function(){return this.throwIfDisposed(),c.log1p(this)},t.prototype.sqrt=function(){return this.throwIfDisposed(),c.sqrt(this)},t.prototype.rsqrt=function(){return this.throwIfDisposed(),c.rsqrt(this)},t.prototype.square=function(){return this.throwIfDisposed(),c.square(this)},t.prototype.reciprocal=function(){return this.throwIfDisposed(),c.reciprocal(this)},t.prototype.abs=function(){return this.throwIfDisposed(),c.abs(this)},t.prototype.clipByValue=function(t,e){return this.throwIfDisposed(),c.clipByValue(this,t,e)},t.prototype.relu=function(){return this.throwIfDisposed(),c.relu(this)},t.prototype.elu=function(){return this.throwIfDisposed(),c.elu(this)},t.prototype.selu=function(){return this.throwIfDisposed(),c.selu(this)},t.prototype.leakyRelu=function(t){return void 0===t&&(t=.2),this.throwIfDisposed(),c.leakyRelu(this,t)},t.prototype.prelu=function(t){return this.throwIfDisposed(),c.prelu(this,t)},t.prototype.sigmoid=function(){return this.throwIfDisposed(),c.sigmoid(this)},t.prototype.logSigmoid=function(){return this.throwIfDisposed(),c.logSigmoid(this)},t.prototype.softplus=function(){return this.throwIfDisposed(),c.softplus(this)},t.prototype.zerosLike=function(){return this.throwIfDisposed(),c.zerosLike(this)},t.prototype.onesLike=function(){return this.throwIfDisposed(),c.onesLike(this)},t.prototype.sin=function(){return this.throwIfDisposed(),c.sin(this)},t.prototype.cos=function(){return this.throwIfDisposed(),c.cos(this)},t.prototype.tan=function(){return this.throwIfDisposed(),c.tan(this)},t.prototype.asin=function(){return this.throwIfDisposed(),c.asin(this)},t.prototype.acos=function(){return this.throwIfDisposed(),c.acos(this)},t.prototype.atan=function(){return this.throwIfDisposed(),c.atan(this)},t.prototype.sinh=function(){return this.throwIfDisposed(),c.sinh(this)},t.prototype.cosh=function(){return this.throwIfDisposed(),c.cosh(this)},t.prototype.tanh=function(){return this.throwIfDisposed(),c.tanh(this)},t.prototype.asinh=function(){return this.throwIfDisposed(),c.asinh(this)},t.prototype.acosh=function(){return this.throwIfDisposed(),c.acosh(this)},t.prototype.atanh=function(){return this.throwIfDisposed(),c.atanh(this)},t.prototype.erf=function(){return this.throwIfDisposed(),c.erf(this)},t.prototype.round=function(){return this.throwIfDisposed(),c.round(this)},t.prototype.step=function(t){return void 0===t&&(t=0),this.throwIfDisposed(),c.step(this,t)},t.prototype.softmax=function(t){return void 0===t&&(t=-1),this.throwIfDisposed(),c.softmax(this,t)},t.prototype.logSoftmax=function(t){return void 0===t&&(t=-1),this.throwIfDisposed(),c.logSoftmax(this,t)},t.prototype.resizeBilinear=function(t,e){return void 0===e&&(e=!1),this.throwIfDisposed(),c.image.resizeBilinear(this,t,e)},t.prototype.resizeNearestNeighbor=function(t,e){return void 0===e&&(e=!1),this.throwIfDisposed(),c.image.resizeNearestNeighbor(this,t,e)},t.prototype.conv1d=function(t,e,r,n,i,o){return void 0===n&&(n="NWC"),void 0===i&&(i=1),this.throwIfDisposed(),c.conv1d(this,t,e,r,n,i,o)},t.prototype.conv2d=function(t,e,r,n,i,o){return void 0===n&&(n="NHWC"),void 0===i&&(i=[1,1]),this.throwIfDisposed(),c.conv2d(this,t,e,r,n,i,o)},t.prototype.conv2dTranspose=function(t,e,r,n,i){return this.throwIfDisposed(),c.conv2dTranspose(this,t,e,r,n,i)},t.prototype.depthwiseConv2D=function(t,e,r,n,i,o){return void 0===n&&(n="NHWC"),void 0===i&&(i=[1,1]),this.throwIfDisposed(),c.depthwiseConv2d(this,t,e,r,n,i,o)},t.prototype.separableConv2d=function(t,e,r,n,i,o){return void 0===i&&(i=[1,1]),void 0===o&&(o="NHWC"),this.throwIfDisposed(),c.separableConv2d(this,t,e,r,n,i,o)},t.prototype.avgPool=function(t,e,r,n){return this.throwIfDisposed(),c.avgPool(this,t,e,r,n)},t.prototype.maxPool=function(t,e,r,n){return this.throwIfDisposed(),c.maxPool(this,t,e,r,n)},t.prototype.localResponseNormalization=function(t,e,r,n){return void 0===t&&(t=5),void 0===e&&(e=1),void 0===r&&(r=1),void 0===n&&(n=.5),c.localResponseNormalization(this,t,e,r,n)},t.prototype.pool=function(t,e,r,n,i){return this.throwIfDisposed(),c.pool(this,t,e,r,n,i)},t.prototype.variable=function(t,e,r){return void 0===t&&(t=!0),this.throwIfDisposed(),p.variable(this,t,e,r)},t.prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),c.unsortedSegmentSum(this,t,e)},t.prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),c.batchToSpaceND(this,t,e)},t.prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),c.spaceToBatchND(this,t,e)},t.prototype.topk=function(t,e){return void 0===t&&(t=1),void 0===e&&(e=!0),this.throwIfDisposed(),c.topk(this,t,e)},t.prototype.stridedSlice=function(t,e,r,n,i,o,s,u){return void 0===n&&(n=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===u&&(u=0),this.throwIfDisposed(),c.stridedSlice(this,t,e,r,n,i,o,s,u)},t.prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),c.depthToSpace(this,t,e)},t.prototype.fft=function(){return this.throwIfDisposed(),c.spectral.fft(this)},t.prototype.ifft=function(){return this.throwIfDisposed(),c.spectral.ifft(this)},t.prototype.rfft=function(){return this.throwIfDisposed(),c.spectral.rfft(this)},t.prototype.irfft=function(){return this.throwIfDisposed(),c.spectral.irfft(this)},t}();e.Tensor=l,Object.defineProperty(l,Symbol.hasInstance,{value:function(t){return!!t&&null!=t.dataId&&null!=t.shape&&null!=t.dtype}});var p=function(t){function e(e,r,n){void 0===r&&(r=!0);var i=t.call(this,e.shape,e.dtype,null,e.dataId)||this;i.trainable=r,i.name=n,null==i.name&&(i.name=h().nextVariableId().toString());try{h().registerVariable(i)}catch(t){throw h().disposeTensor(i),t}return i}return n(e,t),e.variable=function(t,r,n,i){return void 0===r&&(r=!0),null!=i&&i!==t.dtype&&(t=t.asType(i)),new e(t,r,n)},e.prototype.assign=function(t){if(t.dtype!==this.dtype)throw new Error("dtype of the new value ("+t.dtype+") and previous value ("+this.dtype+") must match");if(!m.arraysEqual(t.shape,this.shape))throw new Error("shape of the new value ("+t.shape+") and previous value ("+this.shape+") must match");h().disposeTensor(this),this.dataId=t.dataId,h().registerTensor(this)},e}(l);e.Variable=p,Object.defineProperty(p,Symbol.hasInstance,{value:function(t){return t instanceof l&&null!=t.assign&&t.assign instanceof Function}});var d=p.variable;e.variable=d});u(g);g.TensorBuffer,g.setTensorTracker,g.setOpHandler,g.setDeprecationWarningFn,g.Tensor,g.Variable,g.variable;var b=a(function(t,e){var r,n,i,o;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"}(e.Rank||(e.Rank={})),function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"}(r||(r={})),function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"}(n||(n={})),function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"}(i||(i={})),function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"}(o||(o={}));var s={float32:i,int32:r,bool:n,complex64:o};function u(t,e){if("string"===t||"string"===e){if("string"===t&&"string"===e)return"string";throw new Error("Can not upcast "+t+" with "+e)}return s[t][e]}e.upcastType=u,e.sumOutType=function(t){return u(t,"int32")}});u(b);b.Rank,b.upcastType,b.sumOutType;var x=a(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.makeTypesMatch=function(t,e){if(t.dtype===e.dtype)return[t,e];var r=b.upcastType(t.dtype,e.dtype);return[t.cast(r),e.cast(r)]},e.assertTypesMatch=function(t,e){m.assert(t.dtype===e.dtype,"The dtypes of the first("+t.dtype+") and second("+e.dtype+") input must match")},e.isTensorInList=function(t,e){for(var r=0;r<e.length;r++)if(e[r].id===t.id)return!0;return!1},e.flattenNameArrayMap=function(t,e){var r=[];if(t instanceof g.Tensor)r.push(t);else for(var n=t,i=0;i<e.length;i++)r.push(n[e[i]]);return r},e.unflattenToNameArrayMap=function(t,e){if(t.length!==e.length)throw new Error("Cannot unflatten Tensor[], keys and arrays are not of same length.");for(var r={},n=0;n<t.length;n++)r[t[n]]=e[n];return r},e.getTensorsInContainer=function(t){var e=[];return function t(e,r,n){if(null!=e)if(e instanceof g.Tensor)r.push(e);else if(i=e,Array.isArray(i)||"object"==typeof i){var i,o=e;for(var s in o){var u=o[s];n.has(u)||(n.add(u),t(u,r,n))}}}(t,e,new Set),e}});u(x);x.makeTypesMatch,x.assertTypesMatch;var I=x.isTensorInList,D=(x.flattenNameArrayMap,x.unflattenToNameArrayMap,x.getTensorsInContainer);function S(t,e,r,n){if(void 0===r&&(r=new Map),void 0===n&&(n=new Set),null==t)return null;if(n.has(t))throw new Error("Circular references are not supported.");if(r.has(t))return r.get(t);var i=e(t);if(i.recurse&&null!==i.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(i.recurse){if(k(t)){var o=Array.isArray(t)?[]:{};for(var s in n.add(t),t){var u=S(t[s],e,r,n);o[s]=u}return n.delete(t),o}throw new Error("Can't recurse into non-iterable type: "+t)}return r.set(t,i.value),i.value}function A(t,e){return void 0===e&&(e=T),function t(e,r,n){void 0===n&&(n=new Set);var i=e[0];if(n.has(i))throw new Error("Circular references are not supported.");var o=r(e);if(o.recurse&&null!==o.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(o.recurse){if(k(i)){var s=Array.isArray(i)?[]:{};n.add(i);var u=function(i){var o=e.map(function(t){return t[i]}),u=t(o,r,n);s[i]=u};for(var a in i)u(a);return n.delete(i),s}throw new Error("Can't recurse into non-iterable type: "+i)}return o.value}(t,e)}function T(t){return null===t?null:k(t[0])?{value:null,recurse:!0}:{value:t,recurse:!1}}function E(t,e){return i(this,void 0,void 0,function(){var r,n,i,s,u,a;return o(this,function(o){switch(o.label){case 0:r=new Map,S(t,e,r),n=0,i=Array.from(r.keys()),o.label=1;case 1:return n<i.length?(s=i[n],(u=r.get(s))instanceof Promise?[4,u]:[3,3]):[3,4];case 2:a=o.sent(),r.set(s,a),o.label=3;case 3:return n++,[3,1];case 4:return[2,S(t,e,r)]}})})}function k(t){return null!=t&&(Array.isArray(t)||"object"==typeof t&&!(t instanceof e.Tensor))}var N=function(){function t(t){if(this.capacity=t,this.begin=0,this.end=0,t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}return t.prototype.wrap=function(t){for(;t<0;)t+=this.doubledCapacity;return t%this.doubledCapacity},t.prototype.get=function(t){if(t<0)throw new RangeError("Can't get item at a negative index.");return this.data[t%this.capacity]},t.prototype.set=function(t,e){if(t<0)throw new RangeError("Can't set item at a negative index.");this.data[t%this.capacity]=e},t.prototype.length=function(){var t=this.end-this.begin;return t<0&&(t=this.doubledCapacity+t),t},t.prototype.isFull=function(){return this.length()===this.capacity},t.prototype.isEmpty=function(){return 0===this.length()},t.prototype.push=function(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,t),this.end=this.wrap(this.end+1)},t.prototype.pushAll=function(t){for(var e=0,r=t;e<r.length;e++){var n=r[e];this.push(n)}},t.prototype.pop=function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);var t=this.get(this.end);return this.set(this.end,void 0),t},t.prototype.unshift=function(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,t)},t.prototype.shift=function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var t=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),t},t.prototype.shuffleExcise=function(t){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var e=this.wrap(this.begin+t),r=this.get(e);return this.set(e,this.pop()),r},t}(),z=function(t){function e(){return t.call(this,e.INITIAL_CAPACITY)||this}return n(e,t),e.prototype.isFull=function(){return!1},e.prototype.push=function(e){t.prototype.isFull.call(this)&&this.expand(),t.prototype.push.call(this,e)},e.prototype.unshift=function(e){t.prototype.isFull.call(this)&&this.expand(),t.prototype.unshift.call(this,e)},e.prototype.expand=function(){for(var t=2*this.capacity,e=new Array(t),r=this.length(),n=0;n<r;n++)e[n]=this.get(this.wrap(this.begin+n));this.data=e,this.capacity=t,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=r},e.INITIAL_CAPACITY=32,e}(N);function C(t){return new M(t)}function R(t){return new O(t)}var F,q=function(){function t(){}return t.prototype.collect=function(t,e){return void 0===t&&(t=1e3),void 0===e&&(e=100),i(this,void 0,void 0,function(){var r,n,i,s;return o(this,function(o){switch(o.label){case 0:return r=e>0?this.prefetch(e):this,n=[],i=0,[4,r.next()];case 1:s=o.sent(),o.label=2;case 2:return s.done?[3,4]:(n.push(s.value),++i>=t?[2,n]:[4,r.next()]);case 3:return s=o.sent(),[3,2];case 4:return[2,n]}})})},t.prototype.resolveFully=function(){return i(this,void 0,void 0,function(){var t;return o(this,function(e){switch(e.label){case 0:return[4,this.next()];case 1:t=e.sent(),e.label=2;case 2:return t.done?[3,4]:[4,this.next()];case 3:return t=e.sent(),[3,2];case 4:return[2]}})})},t.prototype.resolveWhile=function(t){return i(this,void 0,void 0,function(){var e,r;return o(this,function(n){switch(n.label){case 0:return[4,this.next()];case 1:e=n.sent(),r=t(e.value),n.label=2;case 2:return e.done||!r?[3,4]:[4,this.next()];case 3:return e=n.sent(),r=t(e.value),[3,2];case 4:return[2]}})})},t.prototype.handleErrors=function(t){return new H(this,t)},t.prototype.filter=function(t){return new B(this,t)},t.prototype.map=function(t){return new U(this,t)},t.prototype.mapAsync=function(t){return new V(this,t)},t.prototype.serialMapAsync=function(t){return new V(this,t).serial()},t.prototype.flatmap=function(t){return new Q(this,t)},t.prototype.forEach=function(t){return i(this,void 0,void 0,function(){return o(this,function(e){return[2,this.map(t).resolveFully()]})})},t.prototype.serialForEach=function(t){return i(this,void 0,void 0,function(){return o(this,function(e){return[2,this.serialMapAsync(t).resolveWhile(function(t){return!0===t})]})})},t.prototype.rowMajorBatch=function(t,e){return void 0===e&&(e=!0),new L(this,t,e)},t.prototype.columnMajorBatch=function(t,e,r){return void 0===e&&(e=!0),void 0===r&&(r=T),this.rowMajorBatch(t,e).map(function(t){return A(t,r)})},t.prototype.concatenate=function(t,e){return new X(C([this,t]),e)},t.prototype.take=function(t){return t<0||null==t?this:new _(this,t)},t.prototype.skip=function(t){return t<0||null==t?this:new j(this,t)},t.prototype.prefetch=function(t){return new Z(this,t)},t.prototype.shuffle=function(t,e){return new Y(this,t,e)},t.prototype.serial=function(){return new P(this)},t}(),M=function(t){function r(e){var r=t.call(this)||this;return r.items=e,r.trav=0,r}return n(r,t),r.prototype.summary=function(){return"Array of "+this.items.length+" items"},r.prototype.next=function(){return i(this,void 0,void 0,function(){var t,r;return o(this,function(n){return this.trav>=this.items.length?[2,{value:null,done:!0}]:(t=this.items[this.trav],r=t instanceof e.Tensor?e.clone(t):t,this.trav++,[2,{value:r,done:!1}])})})},r}(q),O=function(t){function e(e){var r=t.call(this)||this;return r.nextFn=e,r}return n(e,t),e.prototype.summary=function(){return"Function call"},e.prototype.next=function(){return i(this,void 0,void 0,function(){return o(this,function(t){try{return[2,this.nextFn()]}catch(t){throw t.message="Error thrown while iterating through a dataset: "+t.message,t}return[2]})})},e}(q),P=function(t){function e(e){var r=t.call(this)||this;return r.upstream=e,r.lastRead=Promise.resolve({value:null,done:!1}),r}return n(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Serial"},e.prototype.next=function(){return i(this,void 0,void 0,function(){var t=this;return o(this,function(e){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},e.prototype.serialNext=function(){return i(this,void 0,void 0,function(){return o(this,function(t){return[2,this.upstream.next()]})})},e}(q),j=function(t){function r(e,r){var n=t.call(this)||this;return n.upstream=e,n.maxCount=r,n.count=0,n.lastRead=Promise.resolve({value:null,done:!1}),n}return n(r,t),r.prototype.summary=function(){return this.upstream.summary()+" -> Skip"},r.prototype.next=function(){return i(this,void 0,void 0,function(){var t=this;return o(this,function(e){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},r.prototype.serialNext=function(){return i(this,void 0,void 0,function(){var t;return o(this,function(r){switch(r.label){case 0:return this.count++<this.maxCount?[4,this.upstream.next()]:[3,2];case 1:return(t=r.sent()).done?[2,t]:(e.dispose(t.value),[3,0]);case 2:return[2,this.upstream.next()]}})})},r}(q),_=function(t){function e(e,r){var n=t.call(this)||this;return n.upstream=e,n.maxCount=r,n.count=0,n}return n(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Take"},e.prototype.next=function(){return i(this,void 0,void 0,function(){return o(this,function(t){return this.count++>=this.maxCount?[2,{value:null,done:!0}]:[2,this.upstream.next()]})})},e}(q),L=function(t){function e(e,r,n){void 0===n&&(n=!0);var i=t.call(this)||this;return i.upstream=e,i.batchSize=r,i.enableSmallLastBatch=n,i.lastRead=Promise.resolve({value:null,done:!1}),i}return n(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> RowMajorBatch"},e.prototype.next=function(){return i(this,void 0,void 0,function(){var t=this;return o(this,function(e){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},e.prototype.serialNext=function(){return i(this,void 0,void 0,function(){var t,e;return o(this,function(r){switch(r.label){case 0:t=[],r.label=1;case 1:return t.length<this.batchSize?[4,this.upstream.next()]:[3,3];case 2:return(e=r.sent()).done?this.enableSmallLastBatch&&t.length>0?[2,{value:t,done:!1}]:[2,{value:null,done:!0}]:(t.push(e.value),[3,1]);case 3:return[2,{value:t,done:!1}]}})})},e}(q),B=function(t){function r(e,r){var n=t.call(this)||this;return n.upstream=e,n.predicate=r,n.lastRead=Promise.resolve({value:null,done:!1}),n}return n(r,t),r.prototype.summary=function(){return this.upstream.summary()+" -> Filter"},r.prototype.next=function(){return i(this,void 0,void 0,function(){var t=this;return o(this,function(e){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},r.prototype.serialNext=function(){return i(this,void 0,void 0,function(){var t;return o(this,function(r){switch(r.label){case 0:return[4,this.upstream.next()];case 1:return(t=r.sent()).done||this.predicate(t.value)?[2,t]:(e.dispose(t.value),[3,0]);case 2:return[2]}})})},r}(q),U=function(t){function e(e,r){var n=t.call(this)||this;return n.upstream=e,n.transform=r,n}return n(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Map"},e.prototype.next=function(){return i(this,void 0,void 0,function(){var t,e,r,n,i,s,u;return o(this,function(o){switch(o.label){case 0:return[4,this.upstream.next()];case 1:if((t=o.sent()).done)return[2,{value:null,done:!0}];for(e=D(t.value),r=this.transform(t.value),n=D(r),i=0,s=e;i<s.length;i++)u=s[i],I(u,n)||u.dispose();return[2,{value:r,done:!1}]}})})},e}(q),H=function(t){function e(e,r){var n=t.call(this)||this;return n.upstream=e,n.handler=r,n.count=0,n.lastRead=Promise.resolve({value:null,done:!1}),n}return n(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> handleErrors"},e.prototype.next=function(){return i(this,void 0,void 0,function(){var t=this;return o(this,function(e){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},e.prototype.serialNext=function(){return i(this,void 0,void 0,function(){var t;return o(this,function(e){switch(e.label){case 0:e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.upstream.next()];case 2:return[2,e.sent()];case 3:return t=e.sent(),this.handler(t)?[3,4]:[2,{value:null,done:!0}];case 4:return[3,0];case 5:return[2]}})})},e}(q),V=function(t){function e(e,r){var n=t.call(this)||this;return n.upstream=e,n.transform=r,n}return n(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> AsyncMap"},e.prototype.next=function(){return i(this,void 0,void 0,function(){var t,e,r,n,i,s,u;return o(this,function(o){switch(o.label){case 0:return[4,this.upstream.next()];case 1:return(t=o.sent()).done?[2,{value:null,done:!0}]:(e=D(t.value),[4,this.transform(t.value)]);case 2:for(r=o.sent(),n=D(r),i=0,s=e;i<s.length;i++)u=s[i],I(u,n)||u.dispose();return[2,{value:r,done:!1}]}})})},e}(q),W=function(t){function e(){var e=t.call(this)||this;return e.outputQueue=new z,e.lastRead=Promise.resolve({value:null,done:!1}),e}return n(e,t),e.prototype.next=function(){return i(this,void 0,void 0,function(){var t=this;return o(this,function(e){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},e.prototype.serialNext=function(){return i(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return 0!==this.outputQueue.length()?[3,2]:[4,this.pump()];case 1:return t.sent()?[3,0]:[2,{value:null,done:!0}];case 2:return[2,{value:this.outputQueue.shift(),done:!1}]}})})},e}(q),Q=function(t){function e(e,r){var n=t.call(this)||this;return n.upstream=e,n.transform=r,n}return n(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Flatmap"},e.prototype.pump=function(){return i(this,void 0,void 0,function(){var t,e,r,n,i,s,u;return o(this,function(o){switch(o.label){case 0:return[4,this.upstream.next()];case 1:if((t=o.sent()).done)return[2,!1];for(e=D(t.value),r=this.transform(t.value),n=D(r),this.outputQueue.pushAll(r),i=0,s=e;i<s.length;i++)u=s[i],I(u,n)||u.dispose();return[2,!0]}})})},e}(W),X=function(t){function e(e,r){var n=t.call(this)||this;return n.baseErrorHandler=r,n.lastRead=null,n.iterator=null,n.moreIterators=e,n}return n(e,t),e.prototype.summary=function(){return"TODO: fill in upstream of chained summaries -> Chained"},e.prototype.next=function(){return i(this,void 0,void 0,function(){return o(this,function(t){return this.lastRead=this.readFromChain(this.lastRead),[2,this.lastRead]})})},e.prototype.readFromChain=function(t){return i(this,void 0,void 0,function(){var e,r;return o(this,function(n){switch(n.label){case 0:return[4,t];case 1:return n.sent(),null!=this.iterator?[3,3]:[4,this.moreIterators.next()];case 2:if((e=n.sent()).done)return[2,{value:null,done:!0}];this.iterator=e.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler)),n.label=3;case 3:return[4,this.iterator.next()];case 4:return(r=n.sent()).done?(this.iterator=null,[2,this.readFromChain(t)]):[2,r]}})})},e}(q);!function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"}(F||(F={}));var G=function(t){function e(e,r){void 0===r&&(r=F.FAIL);var n=t.call(this)||this;return n.iterators=e,n.mismatchMode=r,n.count=0,n.currentPromise=null,n}return n(e,t),e.prototype.summary=function(){return"{TODO: fill in upstream of zip summaries} -> Zip"},e.prototype.nextState=function(t){return i(this,void 0,void 0,function(){function e(t){return t instanceof q?{value:t.next().then(function(t){return r++,t.done&&n++,t.value}),recurse:!1}:{value:null,recurse:!0}}var r,n,i;return o(this,function(o){switch(o.label){case 0:return[4,t];case 1:return o.sent(),r=0,n=0,[4,E(this.iterators,e)];case 2:if(i=o.sent(),r===n)return[2,{value:null,done:!0}];if(n>0)switch(this.mismatchMode){case F.FAIL:throw new Error("Zipped streams should have the same length. Mismatched at element "+this.count+".");case F.SHORTEST:return[2,{value:null,done:!0}];case F.LONGEST:}return this.count++,[2,{value:i,done:!1}]}})})},e.prototype.next=function(){return i(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return this.currentPromise=this.nextState(this.currentPromise),[4,this.currentPromise];case 1:return[2,t.sent()]}})})},e}(q),Z=function(t){function e(e,r){var n=t.call(this)||this;return n.upstream=e,n.bufferSize=r,n.buffer=new N(r),n}return n(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Prefetch"},e.prototype.refill=function(){for(;!this.buffer.isFull();){var t=this.upstream.next();this.buffer.push(t)}},e.prototype.next=function(){return this.refill(),this.buffer.shift()},e}(q),Y=function(t){function r(r,n,i){var o=t.call(this,r,n)||this;return o.upstream=r,o.windowSize=n,o.upstreamExhausted=!1,o.random=v(i||e.util.now().toString()),o.lastRead=Promise.resolve({value:null,done:!1}),o}return n(r,t),r.prototype.next=function(){return i(this,void 0,void 0,function(){var t=this;return o(this,function(e){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},r.prototype.randomInt=function(t){return Math.floor(this.random()*t)},r.prototype.chooseIndex=function(){return this.randomInt(this.buffer.length())},r.prototype.serialNext=function(){return i(this,void 0,void 0,function(){var t,e;return o(this,function(r){switch(r.label){case 0:this.upstreamExhausted||this.refill(),r.label=1;case 1:return this.buffer.isEmpty()?[3,3]:(t=this.chooseIndex(),[4,this.buffer.shuffleExcise(t)]);case 2:return(e=r.sent()).done?(this.upstreamExhausted=!0,[3,1]):(this.refill(),[2,e]);case 3:return[2,{value:null,done:!0}]}})})},r}(Z),J=function(){function t(){this.size=null}return t.prototype.batch=function(t,r){var n=this;void 0===r&&(r=!0);var s=this;return e.util.assert(t>0,"batchSize need to be positive, but it is\n      "+t),K(function(){return i(n,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,s.iterator()];case 1:return[2,e.sent().columnMajorBatch(t,r,$)]}})})},this.size===1/0||null==this.size?this.size:r?Math.ceil(this.size/t):Math.floor(this.size/t))},t.prototype.concatenate=function(t){var e=this,r=this;return K(function(){return i(e,void 0,void 0,function(){var e,n;return o(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return n=(e=i.sent()).concatenate,[4,t.iterator()];case 2:return[2,n.apply(e,[i.sent()])]}})})},this.size===1/0||t.size===1/0?1/0:null!=this.size&&null!=t.size?this.size+t.size:null)},t.prototype.filter=function(t){var r=this,n=this;return K(function(){return i(r,void 0,void 0,function(){return o(this,function(r){switch(r.label){case 0:return[4,n.iterator()];case 1:return[2,r.sent().filter(function(r){return e.tidy(function(){return t(r)})})]}})})},this.size===1/0?1/0:null)},t.prototype.forEach=function(t){return i(this,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,this.iterator()];case 1:return[2,e.sent().forEach(t)]}})})},t.prototype.map=function(t){var r=this,n=this;return K(function(){return i(r,void 0,void 0,function(){return o(this,function(r){switch(r.label){case 0:return[4,n.iterator()];case 1:return[2,r.sent().map(function(r){return e.tidy(function(){return t(r)})})]}})})},this.size)},t.prototype.mapAsync=function(t){var e=this,r=this;return K(function(){return i(e,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,r.iterator()];case 1:return[2,e.sent().mapAsync(t)]}})})},this.size)},t.prototype.prefetch=function(t){var e=this,r=this;return K(function(){return i(e,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,r.iterator()];case 1:return[2,e.sent().prefetch(t)]}})})},this.size)},t.prototype.repeat=function(t){var e=this,r=this;return K(function(){return i(e,void 0,void 0,function(){var e,n=this;return o(this,function(s){return e=R(function(){return i(n,void 0,void 0,function(){var t;return o(this,function(e){switch(e.label){case 0:return t={},[4,r.iterator()];case 1:return[2,(t.value=e.sent(),t.done=!1,t)]}})})}),[2,(u=e.take(t),new X(u,a))];var u,a})})},null!=this.size&&t>0?this.size*t:0===t?0:null!=this.size&&(void 0===t||t<0)?1/0:null)},t.prototype.skip=function(t){var e=this,r=this;return K(function(){return i(e,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,r.iterator()];case 1:return[2,e.sent().skip(t)]}})})},null!=this.size&&t>=0&&this.size>=t?this.size-t:null!=this.size&&(this.size<t||void 0===t||t<0)?0:null)},t.prototype.shuffle=function(t,r,n){var s=this;void 0===n&&(n=!0);var u=this,a=v(r||e.util.now().toString());return K(function(){return i(s,void 0,void 0,function(){var e;return o(this,function(r){switch(r.label){case 0:return e=a.int32(),n&&(e+=a.int32()),[4,u.iterator()];case 1:return[2,r.sent().shuffle(t,e.toString())]}})})},this.size)},t.prototype.take=function(t){var e=this,r=this;return K(function(){return i(e,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,r.iterator()];case 1:return[2,e.sent().take(t)]}})})},null!=this.size&&this.size>t?t:null!=this.size&&this.size<=t?this.size:null)},t.prototype.toArray=function(){return i(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return[4,this.iterator()];case 1:return[2,t.sent().collect()]}})})},t}();function K(t,e){return void 0===e&&(e=null),new(function(r){function s(){var t=null!==r&&r.apply(this,arguments)||this;return t.size=e,t}return n(s,r),s.prototype.iterator=function(){return i(this,void 0,void 0,function(){return o(this,function(e){return[2,t()]})})},s}(J))}function $(t){if(null===t)return null;var e=t[0];return"string"==typeof e?{value:t,recurse:!1}:k(e)?function(t){if(null==t)return!1;if(!Array.isArray(t))return!1;for(var e in t)if("number"!=typeof t[e])return!1;return!0}(e)?{value:tt(t),recurse:!1}:{value:null,recurse:!0}:{value:tt(t),recurse:!1}}function tt(t){if(0===t.length)throw new Error("Can't make a batch of zero elements.");if(t[0]instanceof e.Tensor)return e.stack(t);if(Array.isArray(t[0]))return function(t){for(var r=t[0].length,n=[t.length,t[0].length],i=new Float32Array(t.length*r),o=0,s=0,u=t;s<u.length;s++){var a=u[s];if(a.length!==r)throw new Error("Elements must have the same shape to be batched");i.set(a,o),o+=r}return e.Tensor.make(n,{values:i})}(t);var r=t;return e.Tensor.make([r.length],{values:new Float32Array(r)})}var et=function(t){function e(e){var r=t.call(this)||this;return r.input=e,r}return n(e,t),e.prototype.iterator=function(){return i(this,void 0,void 0,function(){var t,e;return o(this,function(r){switch(r.label){case 0:return[4,this.input.iterator()];case 1:return t=r.sent(),e=t.decodeUTF8(),[2,e.split("\n")]}})})},e}(J),rt=Symbol("out"),nt=Symbol("field"),it=Symbol("quote"),ot=Symbol("quoteafterquote"),st=Symbol("quoteinquote"),ut=function(t){function r(e,r){var n=t.call(this)||this;return n.input=e,n.hasHeader=!0,n.fullColumnNames=null,n.columnNamesValidated=!1,n.columnConfigs=null,n.configuredColumnsOnly=!1,n.delimiter=",",n.base=new et(e),r||(r={}),n.hasHeader=!1!==r.hasHeader,n.fullColumnNames=r.columnNames,n.columnConfigs=r.columnConfigs,n.configuredColumnsOnly=r.configuredColumnsOnly,n.delimiter=r.delimiter?r.delimiter:",",n}return n(r,t),r.prototype.columnNames=function(){return i(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return this.columnNamesValidated?[3,2]:[4,this.setColumnNames()];case 1:t.sent(),t.label=2;case 2:return[2,this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames]}})})},r.prototype.setColumnNames=function(){return i(this,void 0,void 0,function(){var t,r,n,i,s,u;return o(this,function(o){switch(o.label){case 0:return[4,this.maybeReadHeaderLine()];case 1:if(t=o.sent(),!this.fullColumnNames&&!t)throw new Error("Column names must be provided if there is no header line.");if(this.fullColumnNames&&t&&e.util.assert(t.length===this.fullColumnNames.length,"The length of provided columnNames ("+this.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+t.length.toString()+")."),this.fullColumnNames||(this.fullColumnNames=t),r=this.fullColumnNames.reduce(function(t,e){return t[e]=t[e]+1||1,t},{}),n=Object.keys(r).filter(function(t){return r[t]>1}),e.util.assert(0===n.length,"Duplicate column names found: "+n.toString()),this.columnConfigs)for(i=0,s=Object.keys(this.columnConfigs);i<s.length;i++)if(u=s[i],-1===this.fullColumnNames.indexOf(u))throw new Error('The key "'+u+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").");return this.columnNamesValidated=!0,[2]}})})},r.prototype.maybeReadHeaderLine=function(){return i(this,void 0,void 0,function(){var t;return o(this,function(e){switch(e.label){case 0:return this.hasHeader?[4,this.base.iterator()]:[3,3];case 1:return[4,e.sent().next()];case 2:if((t=e.sent()).done)throw new Error("No data was found for CSV parsing.");return[2,t.value.split(this.delimiter)];case 3:return[2,null]}})})},r.prototype.iterator=function(){return i(this,void 0,void 0,function(){var t,e=this;return o(this,function(r){switch(r.label){case 0:return this.columnNamesValidated?[3,2]:[4,this.setColumnNames()];case 1:r.sent(),r.label=2;case 2:return[4,this.base.iterator()];case 3:return t=r.sent(),this.hasHeader&&(t=t.skip(1)),[2,t.map(function(t){return e.makeDataElement(t)})]}})})},r.prototype.makeDataElement=function(t){for(var e=this.parseRow(t),r={},n={},i=0;i<this.fullColumnNames.length;i++){var o=this.fullColumnNames[i],s=this.columnConfigs?this.columnConfigs[o]:null;if(!this.configuredColumnsOnly||s){var u=e[i],a=null;if(""===u)if(s&&void 0!==s.default)a=s.default;else{if(s&&(s.required||s.isLabel))throw new Error("Required column "+o+" is empty in this line: "+t);a=void 0}else{var h=Number(u);if(isNaN(h))a=s&&"bool"===s.dtype?this.getBoolean(u):u;else if(s&&s.dtype)switch(s.dtype){case"float32":a=h;break;case"int32":a=Math.floor(h);break;case"bool":a=this.getBoolean(u);break;default:a=h}else a=h}s&&s.isLabel?n[o]=a:r[o]=a}}return 0===Object.keys(n).length?r:[r,n]},r.prototype.getBoolean=function(t){return"1"===t||"true"===t.toLowerCase()?1:0},r.prototype.parseRow=function(t){for(var e=[],r=0,n=t.length,i=nt,o=0;o<n;o++)switch(i){case rt:switch(t.charAt(o)){case'"':r=o+1,i=it;break;case this.delimiter:e.push(""),i=rt,r=o+1;break;default:i=nt,r=o}break;case nt:switch(t.charAt(o)){case this.delimiter:e.push(t.substring(r,o)),i=rt,r=o+1}break;case it:switch(t.charAt(o)){case'"':i=ot}break;case ot:switch(t.charAt(o)){case this.delimiter:e.push(t.substring(r,o-1)),i=rt,r=o+1;break;case'"':i=it;break;default:i=st}break;case st:switch(t.charAt(o)){case'"':i=it}}return i===ot?e.push(t.substring(r,n-1)):e.push(t.substring(r)),e},r}(J),at=function(){return function(){}}(),ht=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.split=function(t){return new ct(this,t)},e}(q),ct=function(t){function e(e,r){var n=t.call(this)||this;return n.upstream=e,n.impl=new ft(e,r),n}return n(e,t),e.prototype.summary=function(){return this.impl.summary()},e.prototype.next=function(){return i(this,void 0,void 0,function(){return o(this,function(t){return[2,this.impl.next()]})})},e}(ht),ft=function(t){function e(e,r){var n=t.call(this)||this;return n.upstream=e,n.separator=r,n.carryover="",n}return n(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Split('"+this.separator+"')"},e.prototype.pump=function(){return i(this,void 0,void 0,function(){var t,e,r,n,i;return o(this,function(o){switch(o.label){case 0:return[4,this.upstream.next()];case 1:if((t=o.sent()).done)return""===this.carryover?[2,!1]:(this.outputQueue.push(this.carryover),this.carryover="",[2,!0]);for((e=t.value.split(this.separator))[0]=this.carryover+e[0],r=0,n=e.slice(0,-1);r<n.length;r++)i=n[r],this.outputQueue.push(i);return this.carryover=e[e.length-1],[2,!0]}})})},e}(W),lt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.decodeUTF8=function(){return new pt(this)},e}(q),pt=function(t){function e(e){var r=t.call(this)||this;return r.upstream=e,r.impl=new dt(e),r}return n(e,t),e.prototype.summary=function(){return this.impl.summary()},e.prototype.next=function(){return i(this,void 0,void 0,function(){return o(this,function(t){return[2,this.impl.next()]})})},e}(ht),dt=function(t){function r(r){var n=t.call(this)||this;if(n.upstream=r,e.ENV.get("IS_BROWSER"))n.decoder=new TextDecoder("utf-8");else{var i=require("string_decoder").StringDecoder;n.decoder=new i("utf8")}return n}return n(r,t),r.prototype.summary=function(){return this.upstream.summary()+" -> Utf8"},r.prototype.pump=function(){return i(this,void 0,void 0,function(){var t,r,n;return o(this,function(i){switch(i.label){case 0:return[4,this.upstream.next()];case 1:return(t=i.sent()).done?[2,!1]:(r=t.value,n=e.ENV.get("IS_BROWSER")?this.decoder.decode(r,{stream:!0}):this.decoder.write(Buffer.from(r.buffer)),this.outputQueue.push(n),[2,!0])}})})},r}(W),yt=function(t){function r(r,n){void 0===n&&(n={});var i=t.call(this)||this;return i.file=r,i.options=n,e.util.assert(r instanceof Uint8Array||!!e.ENV.get("IS_BROWSER")&&(r instanceof File||r instanceof Blob),"FileChunkIterator only supports File, Blob and Uint8Array right now."),i.offset=n.offset||0,i.chunkSize=n.chunkSize||1048576,i}return n(r,t),r.prototype.summary=function(){return"FileChunks "+this.file},r.prototype.next=function(){return i(this,void 0,void 0,function(){var t,e,r=this;return o(this,function(n){switch(n.label){case 0:return this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size)?[2,{value:null,done:!0}]:(t=new Promise(function(t,e){var n=r.offset+r.chunkSize;if(r.file instanceof Uint8Array)t(new Uint8Array(r.file.slice(r.offset,n)));else{var i=new FileReader;i.onload=function(r){var n=i.result;if(n instanceof ArrayBuffer&&(n=new Uint8Array(n)),!(n instanceof Uint8Array))return e(new TypeError("FileReader returned unknown type."));t(n)},i.onabort=function(t){return e(new Error("Aborted"))},i.onerror=function(t){return e(new Error(t.type))};var o=r.file.slice(r.offset,n);i.readAsArrayBuffer(o)}r.offset=n}),e={},[4,t]);case 1:return[2,(e.value=n.sent(),e.done=!1,e)]}})})},r}(lt);function vt(t){return"string"==typeof t&&"file://"===t.substr(0,7)}var mt=function(t){function r(e,r){void 0===r&&(r={});var n=t.call(this)||this;return n.input=e,n.options=r,n}return n(r,t),r.prototype.iterator=function(){return i(this,void 0,void 0,function(){var t;return o(this,function(r){return vt(this.input)&&e.ENV.get("IS_NODE")&&(t=require("fs"),this.input=t.readFileSync(this.input.substr(7))),[2,new yt(this.input,this.options)]})})},r}(at),wt=function(t){function r(e,r){void 0===r&&(r={});var n=t.call(this)||this;return n.url=e,n.fileOptions=r,n}return n(r,t),r.prototype.iterator=function(){return i(this,void 0,void 0,function(){return o(this,function(t){return vt(this.url)?[2,new mt(this.url,this.fileOptions).iterator()]:[2,function(t,r){return void 0===r&&(r={}),i(this,void 0,void 0,function(){var n,i,s,u;return o(this,function(o){switch(o.label){case 0:return e.ENV.get("IS_BROWSER")?[4,fetch(t)]:[3,5];case 1:return(n=o.sent()).ok?[4,n.blob()]:[3,3];case 2:return i=o.sent(),[2,new yt(i,r)];case 3:throw new Error(n.statusText);case 4:return[3,9];case 5:if(s=require("node-fetch"),"string"!=typeof t)throw new Error("URL must be a string. Request objects are not supported in the node.js environment yet.");return[4,s(t)];case 6:return(n=o.sent()).ok?[4,n.buffer()]:[3,8];case 7:return u=o.sent(),[2,new yt(u,r)];case 8:throw new Error(n.statusText);case 9:return[2]}})})}(this.url,this.fileOptions)]})})},r}(at);t.array=function(t){var e=this;return K(function(){return i(e,void 0,void 0,function(){return o(this,function(e){return[2,C(t)]})})},t.length)},t.Dataset=J,t.zip=function(t){var e,r=this;if(!k(t))throw new Error("The argument to zip() must be an object or array.");if(Array.isArray(t))for(var n=0;n<t.length;n++)e=null==e?t[n].size:Math.min(e,t[n].size);else if(t instanceof Object)for(var s in t)e=null==e?t[s].size:Math.min(e,t[s].size);return K(function(){return i(r,void 0,void 0,function(){var e;return o(this,function(r){switch(r.label){case 0:return[4,E(t,function(t){if(t instanceof J)return{value:t.iterator(),recurse:!1};if(k(t))return{value:null,recurse:!0};throw new Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")})];case 1:return e=r.sent(),[2,(n=e,i=F.SHORTEST,void 0===i&&(i=F.FAIL),new G(n,i))]}var n,i})})},e)},t.CSVDataset=ut,t.TextLineDataset=et,t.csv=function(t,e){return void 0===e&&(e={}),new ut(new wt(t),e)},t.generator=function(t){var e=this,r=R(t);return K(function(){return i(e,void 0,void 0,function(){return o(this,function(t){return[2,r]})})})},t.FileDataSource=mt,t.URLDataSource=wt,t.version_data="0.2.1",Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=tf-data.min.js.map
